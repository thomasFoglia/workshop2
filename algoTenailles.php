<?php
$prevArray = [
//  0   1  2  3  4  5  6  7  8  9 10 11  12 13 14 15 16 17 18
    [0, 0, 0, 0, 0, 2, 2, 1, 0, 0 ,0 ,0 , 0, 0, 0, 0, 0, 0, 0],//0
    [0, 0, 0, 0, 2, 0, 0, 0, 0, 0 ,0 ,0 , 0, 0, 0, 0, 0, 0, 0],//1
    [0, 0, 0, 0, 2, 0, 0, 0, 0, 0 ,0 ,0 , 0, 0, 0, 0, 0, 0, 0],//2
    [0, 0, 0, 0, 1, 0, 0, 0, 0, 0 ,0 ,0 , 1, 0, 0, 0, 0, 0, 0],//3
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,2 , 0, 0, 0, 0, 0, 0, 0],//4
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,2 ,0 , 0, 0, 0, 0, 0, 0, 0],//5
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 , 0, 0, 0, 0, 0, 0, 0],//6
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 , 0, 0, 0, 0, 0, 0, 0],//7
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 , 0, 0, 0, 0, 0, 0, 0],//8
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 , 0, 0, 0, 0, 0, 0, 0],//9
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,2 , 0, 0, 0, 0, 0, 0, 0],//10
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 , 2, 0, 0, 0, 0, 0, 0],//11
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 , 0, 1, 0, 0, 0, 0, 0],//12
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 , 0, 0, 0, 0, 0, 0, 0],//13
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 , 0, 0, 0, 0, 0, 0, 0],//14
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 , 0, 0, 0, 0, 0, 0, 0],//15
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 , 0, 0, 0, 0, 0, 0, 0],//16
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 , 0, 0, 0, 0, 0, 0, 0],//17
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 , 0, 0, 0, 0, 0, 0, 0]//18
];

$arr = [
//  0   1  2  3  4  5  6  7  8  9 10 11  12 13 14 15 16 17 18
    [0, 0, 0, 0, 0, 2, 2, 1, 0, 0 ,0 ,0 , 0, 0, 0, 0, 0, 0, 0],//0
    [0, 0, 0, 0, 2, 0, 0, 0, 0, 0 ,0 ,0 , 0, 0, 0, 0, 0, 0, 0],//1
    [0, 0, 0, 0, 2, 0, 0, 0, 0, 0 ,0 ,0 , 0, 0, 0, 0, 0, 0, 0],//2
    [0, 0, 0, 0, 1, 0, 0, 0, 0, 0 ,0 ,0 , 1, 0, 0, 0, 0, 0, 0],//3
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,2 , 0, 0, 0, 0, 0, 0, 0],//4
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,2 ,0 , 0, 0, 0, 0, 0, 0, 0],//5
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 , 0, 0, 0, 0, 0, 0, 0],//6
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 , 0, 0, 0, 0, 0, 0, 0],//7
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 , 0, 0, 0, 0, 0, 0, 0],//8
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,1 ,0 , 0, 0, 0, 0, 0, 0, 0],//9
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,2 , 0, 0, 0, 0, 0, 0, 0],//10
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 , 2, 0, 0, 0, 0, 0, 0],//11
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 , 0, 1, 0, 0, 0, 0, 0],//12
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 , 0, 0, 0, 0, 0, 0, 0],//13
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 , 0, 0, 0, 0, 0, 0, 0],//14
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 , 0, 0, 0, 0, 0, 0, 0],//15
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 , 0, 0, 0, 0, 0, 0, 0],//16
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 , 0, 0, 0, 0, 0, 0, 0],//17
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0 ,0 , 0, 0, 0, 0, 0, 0, 0]//18
];


/********************************************************************************/
/***** Détermine la position des pions de chaque joueur [[0,0], [2,1], ...] *****/
/********************************************************************************/

$pts = [];
$numJoueur = 1;
$numEnnemi = ($numJoueur == 1 ? 2 : 1);

//Pour chaque ligne
$i = 0;
foreach($arr as $ligne) {
    //Pour chaque cellule d'une ligne
    $j = 0;
    foreach($ligne as $cell) {
        //Si la case n'est pas vide elle appartient a un joueur
        if ($cell == $numEnnemi) {
            $pts[] = [$j, $i];
        }
        $j++;
    }
    $i++;
}

print_r($pts);
echo "<br/><br/>/////////////<br/><br/>";

/********************************************************************************/
/***** LA TENAILLE                                                          *****/
/********************************************************************************/

$tenailles = 0;

foreach ($pts as $pt) {
    //Est-ce qu'un pion ennemi est a coté de mon $pt ? Est-ce qu'il y a un pion a moi a coté de moi ?

    //Pion allié à droite du pion ennemi ?
    if ($pt[0] != 18 && $arr[$pt[1]][$pt[0] + 1] == $numJoueur) {
        //Pion ennemi a gauche de pion ennemi ?
        if ($pt[0] != 0 && $arr[$pt[1]][$pt[0] - 1] == $numEnnemi) {
            //Pion allié a gauche du pion ennemi qui est a gauche du pion ennemi ? (c'est pas si compliqué, sisi !)
            if ($pt[0] - 1 != 0 && $arr[$pt[1]][$pt[0] - 2] == $numJoueur) {
                //Est-ce que j'ai posé mon pion pour le tenailler ou est-ce qu'il s'est placé entre deux de mes pions ?
                if ($arr[$pt[1]][$pt[0] + 1] != $prevArray[$pt[1]][$pt[0] + 1] || $arr[$pt[1]][$pt[0] - 2] != $prevArray[$pt[1]][$pt[0] - 2]) {
                    $tenailles++;
                    //Enlever les pions
                    echo "<br/>Les pions [" . $pt[0] . ", " . $pt[1] . "] et [" . ($pt[0] - 1) . ", " . $pt[1] . "] sont tenaillés<br/>";
                    $arr[$pt[1]][$pt[0]] = 0;
                    $arr[$pt[1]][$pt[0] - 1] = 0;
                }
            }
        }
    }


    //Pion allié en bas du pion ennemi ?
    if ($pt[1] != 18 && $arr[$pt[1] + 1][$pt[0]] == $numJoueur) {
        //Pion ennemi en haut du pion ennemi ?
        if ($pt[1] != 0 && $arr[$pt[1] - 1][$pt[0]] == $numEnnemi) {
            //Pion allié en haut du pion ennemi qui est en haut du pion ennemi ?
            if ($pt[1] - 1 != 0 && $arr[$pt[1] - 2][$pt[0]] == $numJoueur) {
                //Est-ce que j'ai posé mon pion pour le tenailler ou est-ce qu'il s'est placé entre deux de mes pions ?
                if ($arr[$pt[1] + 1][$pt[0]] != $prevArray[$pt[1] + 1][$pt[0]] || $arr[$pt[1] - 2][$pt[0]] != $prevArray[$pt[1] - 2][$pt[0]]) {
                    $tenailles++;
                    //Enlever les pions
                    echo "<br/>Les pions [" . $pt[0] . ", " . $pt[1] . "] et [" . ($pt[0]) . ", " . ($pt[1] - 1) . "] sont tenaillés<br/>";
                    $arr[$pt[1]][$pt[0]] = 0;
                    $arr[$pt[1] - 1][$pt[0]] = 0;
                }
            }
        }
    }
    
    //Pion allié en diago haut droite du pion ennemi ?
    if ($pt[0] != 18 && $pt[1] != 0 && $arr[$pt[1] - 1][$pt[0] + 1] == $numJoueur) {
        //Pion ennemi en diago bas gauche ?
        if ($pt[0] != 0 && $pt[1] != 18 && $arr[$pt[1] + 1][$pt[0] - 1] == $numEnnemi) {
            //Pion allié en bas gauche du pion ennemi qui est en bas a gauche du pion ennemi ?
            if ($pt[0] - 1 != 0 && $pt[1] + 1 != 18 && $arr[$pt[1] + 2][$pt[0] - 2] == $numJoueur) {
                //Est-ce que j'ai posé mon pion pour le tenailler ou est-ce qu'il s'est placé entre deux de mes pions ?
                if ($arr[$pt[1] - 1][$pt[0] + 1] != $prevArray[$pt[1] - 1][$pt[0] + 1] || $arr[$pt[1] + 2][$pt[0] - 2] != $prevArray[$pt[1] + 2][$pt[0] - 2]) {
                    $tenailles++;
                    //Enlever les pions
                    echo "<br/>Les pions [" . $pt[0] . ", " . $pt[1] . "] et [" . ($pt[1] + 1) . ", " . ($pt[0] - 1) . "] sont tenaillés<br/>";
                    $arr[$pt[1]][$pt[0]] = 0;
                    $arr[$pt[1] + 1][$pt[0] - 1] = 0;
                }
            }
        }
    }

    //Pion allié en diago haut gauche du pion ennemi ?
    if ($pt[0] != 0 && $pt[1] != 0 && $arr[$pt[1] - 1][$pt[0] - 1] == $numJoueur) {
        //Pion ennemi en diago bas droite ?
        if ($pt[0] != 18 && $pt[1] != 18 && $arr[$pt[1] + 1][$pt[0] + 1] == $numEnnemi) {
            //Pion allié en bas droite du pion ennemi qui est en bas a droite du pion ennemi ?
            if ($pt[0] + 1 != 18 && $pt[1] + 1 != 18 && $arr[$pt[1] + 2][$pt[0] + 2] == $numJoueur) {
                //Est-ce que j'ai posé mon pion pour le tenailler ou est-ce qu'il s'est placé entre deux de mes pions ?
                if ($arr[$pt[1] - 1][$pt[0] - 1] != $prevArray[$pt[1] - 1][$pt[0] - 1] || $arr[$pt[1] + 2][$pt[0] + 2] != $prevArray[$pt[1] + 2][$pt[0] + 2]) {
                    $tenailles++;
                    //Enlever les pions
                    echo "<br/>Les pions [" . $pt[0] . ", " . $pt[1] . "] et [" . ($pt[1] + 1) . ", " . ($pt[0] + 1) . "] sont tenaillés<br/>";
                    $arr[$pt[1]][$pt[0]] = 0;
                    $arr[$pt[1] + 1][$pt[0] + 1] = 0;
                }
            }
        }
    }
}

echo $tenailles;

?>
